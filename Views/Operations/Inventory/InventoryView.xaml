<UserControl x:Class="CbcRoastersErp.Views.InventoryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:packIcon="http://materialdesigninxaml.net/winfx/xaml/shared"
             xmlns:local="clr-namespace:CbcRoastersErp.Views"
             xmlns:vm="clr-namespace:CbcRoastersErp.ViewModels"
             Background="{DynamicResource BackgroundBrush}">

    <UserControl.DataContext>
        <vm:InventoryViewModel />
    </UserControl.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Branding Header -->
            <RowDefinition Height="Auto"/>
            <!-- KPI Summary -->
            <RowDefinition Height="*"/>
            <!-- TabControl -->
            <RowDefinition Height="Auto"/>
            <!-- Navigation -->
        </Grid.RowDefinitions>

        <!-- Branding Header -->
        <DockPanel Grid.Row="0" Margin="0 0 0 20">
            <Image Source="/Views/CBC_Logo_500x500.png"
                   Width="50"
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"
                   DockPanel.Dock="Left"/>
            <TextBlock Text="Inventory Management"
                       FontSize="24"
                       FontWeight="Bold"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       Style="{StaticResource Heading1TextBlock}"
                       Margin="10 0 0 0"/>
        </DockPanel>

        <!-- KPI Summary Cards -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0 0 0 20">
            <materialDesign:Card Width="180" Margin="10">
                <Border Margin="5" Padding="10" Background="LightBlue" CornerRadius="6">
                    <StackPanel Margin="10">
                        <TextBlock Text="Green Coffee" FontWeight="Bold"/>
                        <TextBlock Text="{Binding KpiSummary.TotalGreenCoffee, StringFormat={}{0:N0} lbs}" FontSize="18"/>
                    </StackPanel>
                </Border>
            </materialDesign:Card>
            <materialDesign:Card Width="180" Margin="10">
                <Border Margin="5" Padding="10" Background="PaleGreen" CornerRadius="6">
                    <StackPanel Margin="10">
                        <TextBlock Text="Tea" FontWeight="Bold"/>
                        <TextBlock Text="{Binding KpiSummary.TotalTea, StringFormat={}{0:N0} lbs}" FontSize="18"/>
                    </StackPanel>
                </Border>
            </materialDesign:Card>
            <materialDesign:Card Width="180" Margin="10">
                <Border Margin="5" Padding="10" Background="LightGoldenrodYellow" CornerRadius="6">
                    <StackPanel Margin="10">
                        <TextBlock Text="Packing Materials" FontWeight="Bold"/>
                        <TextBlock Text="{Binding KpiSummary.TotalPackingStock, StringFormat={}{0:N0} units}" FontSize="18"/>
                    </StackPanel>
                </Border>
            </materialDesign:Card>
            <materialDesign:Card Width="180" Margin="10">
                <Border Margin="5" Padding="10" Background="LightSalmon" CornerRadius="6">
                    <StackPanel Margin="10">
                        <TextBlock Text="Finished Goods" FontWeight="Bold"/>
                        <TextBlock Text="{Binding KpiSummary.TotalFinishedGoods, StringFormat={}{0:N0} units}" FontSize="18"/>
                    </StackPanel>
                </Border>
            </materialDesign:Card>
        </StackPanel>

        <!-- TabControl for Inventory Categories -->
        <TabControl Grid.Row="2" Style="{StaticResource BrandTabControl}" Margin="0 0 0 20">

            <!-- Green Coffee Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Green Coffee">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="59*"/>
                        <ColumnDefinition Width="715*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Commands -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10" Grid.Column="1">
                        <Button Content="Add/Edit" Command="{Binding OpenAddEditGreenCoffeeCommand}" Style="{StaticResource PrimaryButton}" Margin="5"/>
                        <Button Content="Delete" Command="{Binding DeleteGreenCoffeeCommand}" Style="{StaticResource SecondaryButton}" Margin="5"/>
                    </StackPanel>

                    <!-- DataGrid -->
                    <DataGrid ItemsSource="{Binding GreenCoffeeStock}" SelectedItem="{Binding SelectedGreenCoffee}" AutoGenerateColumns="False" Style="{StaticResource BrandDataGrid}" Grid.ColumnSpan="2" Margin="0,51,0,0" Grid.RowSpan="2">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding CoffeeName}"/>
                            <DataGridTextColumn Header="Origin" Binding="{Binding Origin}"/>
                            <DataGridTextColumn Header="Stock (lbs)" Binding="{Binding Quantity}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Tea Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Tea">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10">
                        <Button Content="Add/Edit" Command="{Binding OpenAddEditTeaCommand}" Style="{StaticResource PrimaryButton}" Margin="5"/>
                        <Button Content="Delete" Command="{Binding DeleteTeaCommand}" Style="{StaticResource SecondaryButton}" Margin="5"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" ItemsSource="{Binding TeaStock}" SelectedItem="{Binding SelectedTea}" AutoGenerateColumns="False" Style="{StaticResource MaterialDesignDataGrid}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding TeaName}"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}"/>
                            <DataGridTextColumn Header="Stock (lbs)" Binding="{Binding Quantity}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Packing Materials Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Packing Materials">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10">
                        <Button Content="Add/Edit" Command="{Binding OpenAddEditPackingCommand}" Style="{StaticResource PrimaryButton}" Margin="5"/>
                        <Button Content="Delete" Command="{Binding DeletePackingCommand}" Style="{StaticResource SecondaryButton}" Margin="5"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" ItemsSource="{Binding PackingStock}" SelectedItem="{Binding SelectedPackingMaterial}" AutoGenerateColumns="False" Style="{StaticResource MaterialDesignDataGrid}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Material" Binding="{Binding MaterialName}"/>
                            <DataGridTextColumn Header="Stock (units)" Binding="{Binding Quantity}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Finished Goods Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Finished Goods">
                <DataGrid ItemsSource="{Binding FinishedGoodsStock}" SelectedItem="{Binding SelectedFinishedGood}" AutoGenerateColumns="False" Style="{StaticResource MaterialDesignDataGrid}" Margin="10">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Product" Binding="{Binding ProductName}"/>
                        <DataGridTextColumn Header="Stock (units)" Binding="{Binding Quantity}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

        </TabControl>

        <!-- Navigation -->
        <Button Grid.Row="3" Content="Back to Dashboard" Command="{Binding NavigateBackCommand}" Style="{StaticResource SecondaryButton}" HorizontalAlignment="Right"/>
    </Grid>
</UserControl>
