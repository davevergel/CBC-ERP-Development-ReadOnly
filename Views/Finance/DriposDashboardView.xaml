<UserControl x:Class="CbcRoastersErp.Views.Finance.DriposDashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1000">

    <Grid Background="White" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header and Filters -->
        <StackPanel Orientation="Horizontal" VerticalAlignment="Top" Margin="0,0,0,10">
            <DatePicker Width="120" Margin="0,0,10,0" SelectedDate="{Binding StartDate, Mode=TwoWay}"/>
            <DatePicker Width="120" Margin="0,0,10,0" SelectedDate="{Binding EndDate, Mode=TwoWay}"/>
            <Button Content="Refresh" Command="{Binding RefreshCommand}" Width="80" Margin="0,0,10,0"/>
            <Button Content="Back" Command="{Binding NavigateBackCommand}" Width="80" Margin="0,0,10,0"/>
            <CheckBox Content="Pie Chart" IsChecked="{Binding ShowPieChart}" VerticalAlignment="Center" Margin="10,0"/>
        </StackPanel>

        <!-- KPI Summary -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,10">
            <TextBlock Text="Total Sales:" FontWeight="Bold" Margin="0,0,20,0"/>
            <TextBlock Text="{Binding CurrentTotal, StringFormat=C}" Margin="0,0,20,0"/>
            <TextBlock Text="Previous Total:" FontWeight="Bold" Margin="0,0,10,0"/>
            <TextBlock Text="{Binding PreviousTotal, StringFormat=C}" Margin="0,0,20,0"/>
            <TextBlock Text="Growth:" FontWeight="Bold" Margin="0,0,10,0"/>
            <TextBlock Text="{Binding GrowthPercent, StringFormat={}{0:N2}%}"/>
        </StackPanel>

        <!-- Chart Area -->
        <Grid Grid.Row="2">
            <lvc:CartesianChart x:Name="BarChart" Visibility="{Binding ShowPieChart, Converter={StaticResource InverseBooleanToVisibilityConverter}}"
                                Series="{Binding SeriesCollection}"
                                LegendLocation="Right">
                <lvc:CartesianChart.AxisX>
                    <lvc:Axis Title="Metric" Labels="{Binding Labels}" LabelsRotation="15"/>
                </lvc:CartesianChart.AxisX>
                <lvc:CartesianChart.AxisY>
                    <lvc:Axis Title="Sales" LabelFormatter="{Binding YFormatter}"/>
                </lvc:CartesianChart.AxisY>
            </lvc:CartesianChart>

            <lvc:PieChart x:Name="PieChart" Visibility="{Binding ShowPieChart, Converter={StaticResource BooleanToVisibilityConverter}}"
                          Series="{Binding PieSeriesCollection}" LegendLocation="Right"/>
        </Grid>
    </Grid>
</UserControl>
