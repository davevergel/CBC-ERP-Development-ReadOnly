<UserControl x:Class="CbcRoastersErp.Views.BigCommerceSyncView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"  
             mc:Ignorable="d"
             Background="{DynamicResource BackgroundBrush}"
             xmlns:vm="clr-namespace:CbcRoastersErp.ViewModels"
             xmlns:models="clr-namespace:CbcRoastersErp.Models"
             Padding="20">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header -->
            <RowDefinition Height="Auto"/>
            <!-- Status Message -->
            <RowDefinition Height="*"/>
            <!-- TabControl -->
            <RowDefinition Height="Auto"/>
            <!-- Back Button -->
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Background="#2c3e50" Padding="20" DockPanel.Dock="Top">
            <StackPanel Orientation="Horizontal" Margin="10">
                <Image Source="/Views/CBC_Logo_500x500.png"
                   Width="50"
                   Height="50"
                   Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="HighQuality"/>
                <TextBlock Text="Sync BigCommerce Orders" Foreground="White"
                           Margin="50 0 0 0"
                           Style="{StaticResource Heading2TextBlock}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Status Message -->
        <TextBlock Grid.Row="1"
                   Text="{Binding StatusMessage}"
                   Foreground="{DynamicResource PrimaryHueMidBrush}"
                   FontWeight="SemiBold"
                   Margin="0 0 0 10"/>

        <!-- TabControl -->
        <TabControl Grid.Row="2" Style="{StaticResource BrandTabControl}" Margin="0 0 0 20">

            <!-- Customers Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Customers">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Sync Customers Button -->
                    <Button Grid.Row="0"
                            Content="Sync Customers"
                            Command="{Binding SyncCustomersCommand}"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Width="150"
                            HorizontalAlignment="Left"
                            Margin="0 0 0 10"/>

                    <!-- Customers DataGrid -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding Customers}"
                              AutoGenerateColumns="False"
                              Style="{StaticResource MaterialDesignDataGrid}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Customer ID" Binding="{Binding CustomerID}"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding FullName}"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}"/>
                            <DataGridTextColumn Header="Phone" Binding="{Binding PhoneNumber}"/>
                        </DataGrid.Columns>
                    </DataGrid>

                </Grid>
            </TabItem>

            <!-- Orders Tab -->
            <TabItem Style="{StaticResource BrandedTabItem}" Header="Orders" Padding="10">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Filters -->
                        <RowDefinition Height="Auto"/>
                        <!-- Action Buttons -->
                        <RowDefinition Height="*"/>
                        <!-- Orders DataGrid -->
                    </Grid.RowDefinitions>

                    <!-- Filters -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0 0 0 10">
                        <ComboBox ItemsSource="{Binding OrderStatuses}"
                                  SelectedItem="{Binding SelectedOrderStatus, Mode=TwoWay}"
                                  DisplayMemberPath="Name"
                                  materialDesign:HintAssist.Hint="Order Status"
                                  Style="{StaticResource BrandedComboBox}"
                                  Width="200"/>

                        <DatePicker SelectedDate="{Binding StartDate, UpdateSourceTrigger=PropertyChanged}"
                                    materialDesign:HintAssist.Hint="Start Date"
                                    Style="{StaticResource BrandedDatePicker}"
                                    Width="150"/>

                        <DatePicker SelectedDate="{Binding EndDate, UpdateSourceTrigger=PropertyChanged}"
                                    materialDesign:HintAssist.Hint="End Date"
                                    Style="{StaticResource BrandedDatePicker}"
                                    Width="150"/>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0 0 0 10">
                        <Button Content="Sync Orders"
                                Command="{Binding SyncOrdersCommand}"
                                Style="{StaticResource PrimaryButton}"
                                Width="150"/>

                        <Button Content="Sync Orders By Date"
                                Command="{Binding SyncOrdersByDateCommand}"
                                Style="{StaticResource PrimaryButton}"
                                Width="180"/>
                    </StackPanel>

                    <!-- Orders DataGrid -->
                    <DataGrid Grid.Row="2"
                              ItemsSource="{Binding Orders}"
                              AutoGenerateColumns="False"
                              Style="{StaticResource MaterialDesignDataGrid}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Order #" Binding="{Binding BigCommerceID}"/>
                            <DataGridTextColumn Header="Customer" Binding="{Binding CustomerName}"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding OrderStatus}"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding DateCreated, StringFormat={}{0:MM/dd/yyyy}}"/>
                            <DataGridTextColumn Header="Total" Binding="{Binding OrderTotal, StringFormat={}{0:C}}"/>
                        </DataGrid.Columns>
                    </DataGrid>

                </Grid>
            </TabItem>

        </TabControl>

        <!-- Back Button -->
        <Button Grid.Row="3"
                Content="Back"
                Command="{Binding NavigateBackCommand}"
                Style="{StaticResource SecondaryButton}"
                HorizontalAlignment="Right"/>
    </Grid>
</UserControl>
